(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,a){e.exports=a(75)},44:function(e,t,a){},64:function(e,t,a){},66:function(e,t,a){},68:function(e,t,a){},70:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(22),c=a.n(s),i=(a(42),a(44),a(77)),l=a(80),o=a(79),m=a(8),u=a(15),p=a(35),d=a(2),f="SET_LOGGED_CUSTOMER",h="CLEAR_LOGGED_CUSTOMER",g="CUSTOMER_LOGIN_PENDING";var v={pending:!1,logged:!1},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(d.a)({},e,{logged:!0,pending:!1,customer:Object(d.a)({},t.payload)});case g:return Object(d.a)({},e,{pending:!0});case h:return Object(d.a)({},e,{logged:!1,customer:null,pending:!1});default:return e}},k=a(4),b=a.n(k),N=a(7),y="https://uxcandy.com/~shapoval/test-task-backend",O="Name";function j(e){return _.apply(this,arguments)}function _(){return(_=Object(N.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.then(function(e){return e.json()},function(e){return{code:504,message:"Server timeout"}}).catch(function(){return t}).then(function(e){return e instanceof Response===!1?e:{status:"error",message:e.statusText}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function w(e){return S.apply(this,arguments)}function S(){return(S=Object(N.a)(b.a.mark(function e(t){var a,n,r,s,c,i,l,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.path,n=t.method,r=void 0===n?"GET":n,s=t.postData,c=t.getParams,r=r.toUpperCase(),i=Object.assign({method:r},"POST"===r?{body:s}:{}),l=y+a+"?developer=".concat(O)+(c?"&"+encodeURI(Object.entries(c).map(function(e){return"".concat(e[0],"=").concat(e[1])}).join("&")):""),o=fetch(l,i),e.next=7,j(o);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var x={get:function(){var e=Object(N.a)(b.a.mark(function e(){var t,a,n=arguments;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,a=n.length>1&&void 0!==n[1]?n[1]:{},e.next=4,w({path:"/",getParams:Object(d.a)({developer:O,page:t},a)});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(N.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({path:"/create",method:"POST",postData:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(N.a)(b.a.mark(function e(t,a){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({path:"/edit/"+a,method:"POST",postData:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},C="REQUEST_TASKS",T="RECEIVE_TASKS",F="SET_TASKS_SORT";function D(e,t){return{type:T,payload:Object(d.a)({},t,{page:e})}}function P(e){return function(){var t=Object(N.a)(b.a.mark(function t(a,n){var r,s,c,i,l,o;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:C}),r=n(),s=r.tasksState,c=s.pagination,i=s.sort,l="undefined"!=typeof e?e:c.page,t.next=5,x.get(l,i||{});case 5:o=t.sent,a(D(l,o));case 7:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}()}function R(){return function(e,t){var a,n=t().tasksState;!(a=n).isFetching&&(!a.items||a.didInvalidate||a.lastUpdate<Date.now()-6e4)&&e(P())}}function L(e){return function(t){t(function(e){return{type:F,payload:e}}(e)),t(P())}}var U={items:null,isFetching:!1,lastUpdate:null,didInvalidate:!1,sort:null,pagination:{page:1},error:null},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return Object(d.a)({},e,{isFetching:!0});case T:var a={isFetching:!1,didInvalidate:!1,lastUpdate:Date.now(),pagination:Object(d.a)({},e.pagination,{page:t.payload.page})};return(t.payload.status=!1)?Object(d.a)({},e,a,{error:t.payload.message,items:null}):Object(d.a)({},e,a,{error:null,items:t.payload.message.tasks,pagination:Object(d.a)({},a.pagination,{total:Math.floor(t.payload.message.total_task_count/3)})});case F:var n={sort_field:t.payload,sort_direction:e.sort&&e.sort.sort_field===t.payload&&"asc"===e.sort.sort_direction?"desc":"asc"};return Object(d.a)({},e,{sort:Object(d.a)({},n)});default:return e}},G=Object(u.c)({loggedCustomerState:E,tasksState:I}),A=[p.a],B=Object(u.d)(G,void 0,u.a.apply(void 0,A)),M=a(9),K=a(10),J=a(12),W=a(11),Q=a(13),V=a(78),$=a(18),q=(a(62),a(64),a(16));var z=function(e){function t(e){var a;return Object(M.a)(this,t),(a=Object(J.a)(this,Object(W.a)(t).call(this,e))).updateState=function(e){a.setState(Object(q.a)({},e.target.name,e.target.value))},a.doLogout=function(e){(0,a.props.dispatch)({type:h}),e.preventDefault()},a.doLogin=function(e){e.preventDefault();var t=a.state,n=t.name,r=t.password;if("admin"===n&&"123"===r){var s=a.props.dispatch;s({type:g}),setTimeout(function(){s({type:f,payload:{name:"Admin",login:"admin",role:"admin"}})},3e3)}else $.toast.error("Credentials uncorrect")},a.state={name:"",password:""},a}return Object(Q.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this.props.customer,t=this.state,a=t.name,n=t.password;return r.a.createElement(r.a.Fragment,null,e?r.a.createElement("span",{className:"navbar-text float-right"},e.name,r.a.createElement("a",{href:"/logout",onClick:this.doLogout}," Logout")):r.a.createElement("form",{className:"form-inline my-2 my-lg-0",onSubmit:this.doLogin},r.a.createElement("input",{id:"name",className:"form-control mr-sm-2",type:"text",name:"name",placeholder:"Login",onChange:this.updateState}),r.a.createElement("input",{id:"password",className:"form-control mr-sm-2",type:"password",name:"password",placeholder:"Password",onChange:this.updateState}),r.a.createElement("button",{className:"btn btn-outline-success my-2 my-sm-0",type:"submit",disabled:!(a&&n)},"Login")))}}]),t}(n.Component),H=Object(m.b)(function(e){var t=e.loggedCustomerState.customer;return{customer:void 0===t?null:t}})(z),X=a(76),Y=function(){return r.a.createElement("header",null,r.a.createElement("nav",{className:"navbar navbar-light bg-light"},r.a.createElement(X.a,{className:"navbar-brand",to:"/"},"BrandName"),r.a.createElement(X.a,{className:"navbar-Link",to:"/task/create"},"Create new"),r.a.createElement(H,null)))},Z=function(){return r.a.createElement("footer",null,r.a.createElement("div",{className:"container"},"Copyrights 2018"))},ee=(a(66),function(e){var t=e.dark,a=e.relative;return r.a.createElement("div",{className:"loading"+(t?" m-dark":"")+(a?" m-relative":"")},r.a.createElement("div",{className:"signal"}))}),te=(a(68),function(e,t){for(var a=[],n=1;n<=t;n++)(n<=e&&n>e-3||n>=e&&n<e+3)&&a.push(n);return a}),ae=function(e){var t=e.pagination,a=e.loadPage,n=t.page,s=t.total,c=te(n,s);return r.a.createElement("nav",{"aria-label":"Page navigation example"},r.a.createElement("ul",{className:"pagination"},1!==n&&r.a.createElement("li",{className:"page-item"},r.a.createElement("a",{className:"page-link",href:"#",onClick:function(){return a(1)}},"First")),r.a.createElement("li",{className:"page-item d-none d-md-block".concat(1==n?" disabled":"")},r.a.createElement("a",{className:"page-link",href:"#",onClick:function(){return a(n-1)}},"Previous")),c[0]>1&&r.a.createElement("li",{className:"page-item d-none d-md-block disabled"},r.a.createElement("a",{className:"page-link",href:"#"},"...")),c.map(function(e){return r.a.createElement("li",{key:e,className:"page-item".concat(n===e?" active":"")},r.a.createElement("a",{className:"page-link",href:"#",onClick:function(){return a(e)}},e))}),c[c.length-1]<s&&r.a.createElement("li",{className:"page-item d-none d-md-block disabled"},r.a.createElement("a",{className:"page-link",href:"#"},"...")),r.a.createElement("li",{className:"page-item d-none d-md-block".concat(n==s?" disabled":"")},r.a.createElement("a",{className:"page-link",href:"#",onClick:function(){return a(n+1)}},"Next")),n!=s&&r.a.createElement("li",{className:"page-item"},r.a.createElement("a",{className:"page-link",href:"#",onClick:function(){return a(s)}},"Last"))))};var ne=function(e){function t(){var e,a;Object(M.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(J.a)(this,(e=Object(W.a)(t)).call.apply(e,[this].concat(r)))).loadPage=function(e){(0,a.props.dispatch)(P(e))},a.viewTask=function(e){a.props.history.push("/task/view/"+e)},a.sortTasks=function(e){(0,a.props.dispatch)(L(e))},a}return Object(Q.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(R())}},{key:"render",value:function(){var e=this,t=this.props,a=t.tasks,n=t.pagination,s=t.isFetching;t.history;return r.a.createElement("div",{className:"task-list"},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Task list"),r.a.createElement("ul",{className:"task-list__list"},r.a.createElement("li",{className:"task-list__title"},r.a.createElement("div",{className:"task-list__status"},r.a.createElement("a",{href:"#",onClick:function(){return e.sortTasks("state")}},"St")),r.a.createElement("div",{className:"task-list__name"},r.a.createElement("a",{href:"#",onClick:function(){return e.sortTasks("username")}},"User name")),r.a.createElement("div",{className:"task-list__email"},r.a.createElement("a",{href:"#",onClick:function(){return e.sortTasks("email")}},"Email")),r.a.createElement("div",{className:"task-list__text"},"Text"),r.a.createElement("div",{className:"task-list__id"},r.a.createElement("a",{href:"#",onClick:function(){return e.sortTasks("id")}},"ID"))),a.map(function(t,a){return r.a.createElement("li",{key:t.id,className:"task-list__item",onClick:function(){return e.viewTask(t.id)}},r.a.createElement("div",{className:"task-list__status"},r.a.createElement("input",{type:"checkbox",checked:t.status,disabled:!0})),r.a.createElement("div",{className:"task-list__name"},t.username),r.a.createElement("div",{className:"task-list__email"},t.email),r.a.createElement("div",{className:"task-list__text"},t.text),r.a.createElement("div",{className:"task-list__id"},t.id))})),r.a.createElement(ae,{pagination:n,loadPage:this.loadPage})):r.a.createElement("div",null,s?"":"Task list is empty"),s&&r.a.createElement("div",null,"Loading..."))}}]),t}(n.Component),re=Object(m.b)(function(e){var t=e.tasksState;return{tasks:t.items,pagination:t.pagination,isFetching:t.isFetching,sort:t.sort}})(ne),se=(a(70),a(36)),ce=a.n(se);var ie=function(e){function t(e){var a;return Object(M.a)(this,t),(a=Object(J.a)(this,Object(W.a)(t).call(this,e))).updateState=function(e){var t,n=e.target;t="checkbox"==n.type?n.checked:"file"==n.type?{files:n.files,value:n.value}:n.value,a.setState(function(e){return{task:Object(d.a)({},e.task,Object(q.a)({},n.name,t))}})},a.update=Object(N.a)(b.a.mark(function e(){var t,n,r,s,c,i,l,o,m;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new FormData,"beejee",n=a.state.task,r=n.text,s=n.status,c=n.id,i={token:"beejee",text:r,status:s=s?10:0},(l=Object.entries(i).sort(function(e,t){return e[0]>t[0]})).forEach(function(e){return t.append(e[0],e[1])}),o=l.map(function(e){return encodeURIComponent(e[0])+"="+encodeURIComponent(e[1])}).join("&"),t.append("signature",ce()(o)),e.next=11,x.update(t,c);case 11:m=e.sent,a.handleResponse(m);case 13:case"end":return e.stop()}},e,this)})),a.create=function(){var e=Object(N.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.create(t);case 2:n=e.sent,a.handleResponse(n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.handleResponse=function(e){"ok"==e.status?(a.props.dispatch(P()),a.props.history.push("/")):a.setState({error:Object.entries(e.message).map(function(e){return"".concat(e[0]," - ").concat(e[1])})})},a.submit=function(e){e.preventDefault();var t=new FormData(e.target);"create"==a.state.mode?a.create(t):a.update(t)},a.previewToggle=function(){a.state.preview?a.form=a.formData:a.formData=a.form,a.setState(function(e){return{preview:!e.preview}})},a.state={preview:!1,error:null},a.form=r.a.createRef(),a}return Object(Q.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.history,n=t.customer,s=this.state,c=s.task,i=s.mode,l=s.preview,o=s.error;return"edit"!=i||n&&"admin"==n.role?r.a.createElement("div",{className:"task-item"},r.a.createElement("h1",null,"Task"),/create|edit/.test(i)&&r.a.createElement("div",{className:"task-item__content"},r.a.createElement("form",{className:l?" d-none":"",name:"task",onSubmit:this.submit},"create"==i&&r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"task-username"},"User name"),r.a.createElement("input",{type:"text",className:"form-control",id:"task-username",name:"username",placeholder:"User name",value:c.username,onChange:this.updateState})),"create"==i&&r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"task-username"},"Email"),r.a.createElement("input",{type:"email",className:"form-control",id:"task-email",name:"email",placeholder:"Email",value:c.email,onChange:this.updateState})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"task-text"},"Text"),r.a.createElement("input",{type:"text",className:"form-control",id:"task-text",name:"text",placeholder:"Text",value:c.text,onChange:this.updateState})),"create"==i&&r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"task-image"},"Image"),r.a.createElement("input",{type:"file",className:"form-control-file",id:"task-image",name:"image",accept:".jpg, .jpeg, .png",files:c.image&&c.image.files,value:c.image&&c.image.value,onChange:this.updateState})),"edit"==i&&r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"task-status"},"Status"),r.a.createElement("input",{type:"checkbox",className:"form-control-file",id:"task-status",name:"status",checked:c.status,onChange:this.updateState})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary"},"Save")))),("view"==i||l)&&r.a.createElement("div",{className:"task-item__content"},r.a.createElement("p",null,r.a.createElement("span",{className:"task-item__title"},"id:")," ",c.id),"create"!=i&&r.a.createElement("p",null,r.a.createElement("span",{className:"task-item__title"},"status: "),r.a.createElement("input",{type:"checkbox",disabled:!0,checked:c.status})),r.a.createElement("p",null,r.a.createElement("span",{className:"task-item__title"},"username:")," ",c.username),r.a.createElement("p",null,r.a.createElement("span",{className:"task-item__title"},"email:")," ",c.email),r.a.createElement("p",null,r.a.createElement("span",{className:"task-item__title"},"text:")," ",c.text),r.a.createElement("p",null,r.a.createElement("span",{className:"task-item__title"},"image")),r.a.createElement("img",{className:"task-item__img",src:c.image_path||c.image&&URL.createObjectURL(c.image.files[0]),alt:""})),o&&r.a.createElement("div",{className:"alert alert-danger",role:"alert"},r.a.createElement("ul",null,o.map(function(e){return r.a.createElement("li",{key:e},e)}))),r.a.createElement("p",null),r.a.createElement("nav",null,r.a.createElement("a",{className:"btn btn-light",href:"#",onClick:function(){a.goBack()}},"Back"),"view"==i&&n&&"admin"===n.role&&r.a.createElement("button",{className:"btn btn-secondary",type:"button",onClick:function(){return a.push("/task/edit/"+c.id)}},"Edit")," ",/edit|create/.test(i)&&r.a.createElement("button",{className:"btn btn-secondary",type:"button",onClick:function(){return e.setState(function(e){return{preview:!e.preview}})}},l?"Back to edit":"Preview"))):r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"Permission denied! Please login as admin.")}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.match.params,n=a.mode,r=a.id,s=e.tasks;if(n===t.mode)return t;var c=/view|edit/.test(n)&&+r&&s&&s.find(function(e){return e.id===+r})||{username:"",email:"",text:"",image:""};return{task:Object(d.a)({},c,{image:""}),mode:n,preview:!1}}}]),t}(n.Component),le=Object(m.b)(function(e){return{tasks:e.tasksState.items,customer:e.loggedCustomerState.customer}})(ie);var oe=function(e){function t(){return Object(M.a)(this,t),Object(J.a)(this,Object(W.a)(t).apply(this,arguments))}return Object(Q.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this.props.pending;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,null),r.a.createElement("div",{className:"container main-content"},r.a.createElement(l.a,null,r.a.createElement(o.a,{path:"/",exact:!0,component:re}),r.a.createElement(o.a,{path:"/task/:mode(edit||view)/:id(\\d+)",component:le}),r.a.createElement(o.a,{path:"/task/:mode(create)",component:le}),r.a.createElement(V.a,{to:"/"}))),r.a.createElement(Z,null),r.a.createElement($.ToastContainer,{autoClose:2e3}),e&&r.a.createElement(ee,{dark:!0}))}}]),t}(n.Component),me=Object(m.b)(function(e){return{pending:e.loggedCustomerState.pending}})(oe),ue=function(){return r.a.createElement(m.a,{store:B},r.a.createElement(i.a,null,r.a.createElement(l.a,null,r.a.createElement(o.a,{path:"/",component:me}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[37,2,1]]]);
//# sourceMappingURL=main.52dcd96f.chunk.js.map